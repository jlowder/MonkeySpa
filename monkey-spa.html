<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monkey Spa</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM2NjdlZWE7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6Izc2NGJhMjtzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgcng9IjYiIGZpbGw9InVybCgjZ3JhZCkiLz4KICA8cmVjdCB4PSI0IiB5PSI0IiB3aWR0aD0iOCIgaGVpZ2h0PSI4IiByeD0iMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuOSIvPgogIDxyZWN0IHg9IjE0IiB5PSI0IiB3aWR0aD0iOCIgaGVpZ2h0PSI4IiByeD0iMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuOSIvPgogIDxyZWN0IHg9IjI0IiB5PSI0IiB3aWR0aD0iNCIgaGVpZ2h0PSI4IiByeD0iMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNyIvPgogIDxyZWN0IHg9IjQiIHk9IjE0IiB3aWR0aD0iOCIgaGVpZ2h0PSI4IiByeD0iMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuOSIvPgogIDxyZWN0IHg9IjE0IiB5PSIxNCIgd2lkdGg9IjgiIGhlaWdodD0iOCIgcng9IjIiIGZpbGw9IndoaXRlIiBvcGFjaXR5PSIwLjkiLz4KICA8cmVjdCB4PSIyNCIgeT0iMTQiIHdpZHRoPSI0IiBoZWlnaHQ9IjgiIHJ4PSIyIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC43Ii8+CiAgPHJlY3QgeD0iNCIgeT0iMjQiIHdpZHRoPSI4IiBoZWlnaHQ9IjQiIHJ4PSIyIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC43Ii8+CiAgPHJlY3QgeD0iMTQiIHk9IjI0IiB3aWR0aD0iOCIgaGVpZ2h0PSI0IiByeD0iMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNyIvPgogIDxyZWN0IHg9IjI0IiB5PSIyNCIgd2lkdGg9IjQiIGhlaWdodD0iNCIgcng9IjIiIGZpbGw9IndoaXRlIiBvcGFjaXR5PSIwLjUiLz4KPC9zdmc+">
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    color: #333;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    background: rgba(255, 255, 255, 0.95);
    padding: 20px 30px;
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
}

.header h1 {
    color: #4a5568;
    font-size: 2rem;
    font-weight: 700;
    display: flex;
    align-items: center;
}

h1 img {
  margin-right: 25px; 
}

.header h1 i {
    margin-right: 10px;
    color: #667eea;
}

.header-actions {
    display: flex;
    gap: 20px;
    align-items: center;
}

.search-container {
    position: relative;
}

.search-input {
    padding: 12px 45px 12px 15px;
    border: 2px solid #e2e8f0;
    border-radius: 25px;
    font-size: 14px;
    width: 300px;
    transition: all 0.3s ease;
}

.search-input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.search-icon {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: #a0aec0;
}

.filters {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    background: rgba(255, 255, 255, 0.9);
    padding: 15px 20px;
    border-radius: 10px;
    backdrop-filter: blur(10px);
}

.filter-controls {
    display: flex;
    gap: 15px;
}

.version-info {
    display: flex;
    align-items: center;
    gap: 15px;
}

.github-link {
    color: #4a5568;
    text-decoration: none;
    font-size: 14px;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 5px;
    transition: color 0.3s ease;
}

.github-link:hover {
    color: #667eea;
}

.version-number {
    color: #718096;
    font-size: 12px;
    font-weight: 500;
}

.filter-select {
    padding: 8px 15px;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    background: white;
    font-size: 14px;
    cursor: pointer;
}

.btn {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn-primary {
    background: #667eea;
    color: white;
}

.btn-primary:hover {
    background: #5a67d8;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn-secondary {
    background: #e2e8f0;
    color: #4a5568;
}

.btn-secondary:hover {
    background: #cbd5e0;
}

.btn-danger {
    background: #e53e3e;
    color: white;
}

.btn-danger:hover {
    background: #c53030;
}

.webapp-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 25px;
    margin-bottom: 40px;
}

.webapp-card {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    overflow: hidden;
    border: 1px solid rgba(0, 0, 0, 0.15);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    cursor: pointer;
    backdrop-filter: blur(10px);
}

.webapp-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 16px 50px rgba(0, 0, 0, 0.25);
    border-color: rgba(0, 0, 0, 0.25);
}

.webapp-screenshot {
    width: 100%;
    height: 200px;
    background: linear-gradient(45deg, #f7fafc, #edf2f7);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    color: #a0aec0;
    position: relative;
    overflow: hidden;
}

.webapp-screenshot img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0;
}

.webapp-screenshot.loading {
    background: linear-gradient(45deg, #f7fafc, #edf2f7);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #a0aec0;
}

.webapp-screenshot.loading .loading-spinner {
    width: 40px;
    height: 40px;
    border: 4px solid #e2e8f0;
    border-top: 4px solid #667eea;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 10px;
}

.webapp-screenshot.loading .loading-text {
    font-size: 14px;
    font-weight: 600;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.webapp-screenshot .placeholder-icon {
    font-size: 4rem;
    color: #cbd5e0;
}

.webapp-info {
    padding: 20px;
}

.webapp-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.webapp-actions {
    display: flex;
    gap: 8px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.webapp-card:hover .webapp-actions {
    opacity: 1;
}

.action-btn {
    padding: 6px 8px;
    border: none;
    border-radius: 6px;
    background: #f7fafc;
    color: #4a5568;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s ease;
}

.action-btn:hover {
    background: #e2e8f0;
}

.action-btn.edit:hover {
    background: #bee3f8;
    color: #2b6cb0;
}

.action-btn.delete:hover {
    background: #fed7d7;
    color: #c53030;
}

.webapp-description {
    color: #718096;
    font-size: 14px;
    line-height: 1.5;
    margin-bottom: 15px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.webapp-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 12px;
    color: #a0aec0;
    margin-bottom: 10px;
}

.webapp-category {
    background: #667eea;
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 600;
}

.webapp-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 10px;
}

.tag {
    background: #f7fafc;
    color: #4a5568;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 11px;
    border: 1px solid #e2e8f0;
}

.empty-state {
    text-align: center;
    padding: 80px 20px;
    color: rgba(255, 255, 255, 0.8);
}

.empty-state i {
    font-size: 4rem;
    margin-bottom: 20px;
    opacity: 0.6;
}

.empty-state h3 {
    font-size: 1.5rem;
    margin-bottom: 10px;
}

.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
}

.modal-content {
    background-color: white;
    margin: 5% auto;
    padding: 0;
    border-radius: 15px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: modalSlideIn 0.3s ease;
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-50px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 25px 30px;
    border-bottom: 1px solid #e2e8f0;
}

.modal-header h2 {
    color: #2d3748;
    font-size: 1.5rem;
}

.close {
    color: #a0aec0;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    transition: color 0.3s ease;
}

.close:hover {
    color: #4a5568;
}

.modal form {
    padding: 30px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #4a5568;
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 12px 15px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.3s ease;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.form-group small {
    color: #718096;
    font-size: 12px;
    margin-top: 5px;
    display: block;
}

.form-actions {
    display: flex;
    gap: 15px;
    justify-content: flex-end;
    margin-top: 30px;
}

/* Import/Export Modal Styles */
.format-options {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 20px;
}

.import-options {
    margin: 20px 0;
    padding: 15px;
    background: #f7fafc;
    border-radius: 8px;
}

.import-options label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
    cursor: pointer;
    font-weight: normal;
}

.import-options input[type="radio"] {
    width: auto;
    margin: 0;
}

/* Notification Styles */
.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: white;
    padding: 15px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    display: flex;
    align-items: center;
    gap: 10px;
    z-index: 1001;
    transform: translateX(400px);
    opacity: 0;
    transition: all 0.3s ease;
    max-width: 350px;
}

.notification.show {
    transform: translateX(0);
    opacity: 1;
}

.notification-success {
    border-left: 4px solid #48bb78;
}

.notification-success i {
    color: #48bb78;
}

.notification-error {
    border-left: 4px solid #e53e3e;
}

.notification-error i {
    color: #e53e3e;
}

.notification-info {
    border-left: 4px solid #4299e1;
}

.notification-info i {
    color: #4299e1;
}

.notification span {
    font-size: 14px;
    color: #2d3748;
    font-weight: 500;
}

@media (max-width: 768px) {
    .header {
        flex-direction: column;
        gap: 20px;
        text-align: center;
    }
    
    .header-actions {
        flex-wrap: wrap;
        justify-content: center;
        width: 100%;
    }
    
    .search-input {
        width: 100%;
    }
    
    .webapp-grid {
        grid-template-columns: 1fr;
    }
    
    .filters {
        flex-direction: column;
        gap: 15px;
    }
    
    .filter-controls {
        flex-direction: column;
        width: 100%;
    }
    
    .version-info {
        justify-content: center;
        width: 100%;
    }
    
    .form-actions {
        flex-direction: column;
    }
    
    .format-options {
        flex-direction: column;
    }
    
    .notification {
        right: 10px;
        left: 10px;
        max-width: none;
        transform: translateY(-100px);
    }
    
    .notification.show {
        transform: translateY(0);
    }
}
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
		<h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEMAAAA9CAYAAAD24tTCAAAAxnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjabVBBDsQgCLzzin2CCCo+x27bZH+wz9+x4qZtOokjMmQEaPt+dnp1RFbSVCzXnAOgVWtsCCwMtIM56MEHVFzja55kdSEi1Yu80LLXzzz/DcbVEKWTkb1dWK5CVfe3m5F/JL2jiMAboepGEofAbtDGWCFXK+cRli1cYeNQp33upIzr/taC7a0J/0iMm7AEsEgeDUg/iaQhMLAI1oEiRgwBrDJHxUKe9jRBP2WFWbzPEeyDAAABfGlDQ1BpY2MAAHicfZE9SMNAHMVfW6VFKoJ2UBHMUJ3soiKOtQpFqBBqhVYdTC79giYNSYqLo+BacPBjserg4qyrg6sgCH6AuAtOii5S4v+SQosYD4778e7e4+4d4G9UmGp2xQFVs4x0MiFkc6tC8BUhjKIfQwhIzNTnRDEFz/F1Dx9f72I8y/vcn6NXyZsM8AnEcaYbFvEG8cympXPeJ46wkqQQnxNPGHRB4keuyy6/cS467OeZESOTnieOEAvFDpY7mJUMlXiaOKqoGuX7sy4rnLc4q5Uaa92TvzCc11aWuU5zBEksYgkiBMiooYwKLMRo1Ugxkab9hId/2PGL5JLJVQYjxwKqUCE5fvA/+N2tWZiadJPCCaD7xbY/xoDgLtCs2/b3sW03T4DAM3Cltf3VBjD7SXq9rUWPgL5t4OK6rcl7wOUOMPikS4bkSAGa/kIBeD+jb8oBA7dAz5rbW2sfpw9AhrpK3QAHh8B4kbLXPd4d6uzt3zOt/n4AdSdypyhA67sAAA14aVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjg4MzcxZjIxLWM2MTgtNGJmMi1hNDYyLTdhNzZmY2EwNDMxYyIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2NjFkOTY5ZC02MzhlLTRlOTAtOTk1ZS1jZmMyNzdkYTlhZDMiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NGEwNmZkZi01NzRkLTRmNTUtOThmYy0zNGExZmUwNGZmYWMiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE3NTY2NjQ3NDU5Nzk0NzEiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zNiIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiCiAgIHhtcDpNZXRhZGF0YURhdGU9IjIwMjU6MDg6MzFUMTE6MjU6NDUtMDc6MDAiCiAgIHhtcDpNb2RpZnlEYXRlPSIyMDI1OjA4OjMxVDExOjI1OjQ1LTA3OjAwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YTc2ODU3NzUtNDZhZi00Yjk3LWJkMGEtMTY0NzQ5ZDA0N2M3IgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKExpbnV4KSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyNS0wOC0zMVQxMToyNTo0NS0wNzowMCIvPgogICAgPC9yZGY6U2VxPgogICA8L3htcE1NOkhpc3Rvcnk+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz7M86J3AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH6QgfEhktBOhukQAAGrFJREFUeNq1m3mUXVWV/z/73PvuG+vVXJVKKklVZR7IPBAyYwgsYuw2EmZ/CoqoQfmJ0jiALlrRFruxQQW1WdIgAmqroICQEAgEBSEmhoRIEjJPNQ+vxjfce35/nDdWqkL4tbm17qr3zjvn3rP32fu7v2efcwAkc2/Zgrz8MtLQkCv76EeRm2/OfR9819YijzyCnHee+V5Sgnz/+6bN//wP8pnP5OpOnIjs3o089xxSVITMnI78TiMVY/ABJcU+6sI+ZihhQjBM0QX35NrOnIls347cddfwffngB5HrrkPuuw/x+01ZIIC89BJy5Mjw7QD5z/9EMl8AOP98aG2FI0cgmUQAzXtcInD11fDcc9DWZsqmT4ddu+Cmm+D++xFtnqKrq6GhAf62A0aPhfZurGQL9aMCzKl0GAOMak9Q154kGEuxf8DjF0mPNwGXs7h+8APo7oZ334Vf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" alt="Monkey's Paw"> Monkey Spa</h1>
            <div class="header-actions">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search webapps..." class="search-input">
                    <i class="fas fa-search search-icon"></i>
                </div>
                <button id="addAppBtn" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Add Webapp
                </button>
                <button id="exportBtn" class="btn btn-secondary">
                    <i class="fas fa-download"></i> Export
                </button>
                <button id="importBtn" class="btn btn-secondary">
                    <i class="fas fa-upload"></i> Import
                </button>
            </div>
        </header>

        <div class="filters">
            <div class="filter-controls">
                <select id="sortSelect" class="filter-select">
                    <option value="dateAdded">Sort by Date Added</option>
                    <option value="name">Sort by Name</option>
                    <option value="lastUsed">Sort by Last Used</option>
                </select>
                <select id="categoryFilter" class="filter-select">
                    <option value="">All Categories</option>
		    <option value="devtools">Dev Tools</option>
		    <option value="research">Research</option>
                    <option value="productivity">Productivity</option>
                    <option value="utilities">Utilities</option>
                    <option value="fun">Fun</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="version-info">
                <a href="https://github.com/jlowder/MonkeySpa" target="_blank" class="github-link">
                    <i class="fab fa-github"></i> GitHub
                </a>
                <span class="version-number">v1.0.1</span>
            </div>
        </div>

        <div id="webappGrid" class="webapp-grid">
            <!-- Webapp cards will be dynamically inserted here -->
        </div>

        <div id="emptyState" class="empty-state" style="display: none;">
            <i class="fas fa-folder-open"></i>
            <h3>No webapps found</h3>
            <p>Add your first webapp to get started!</p>
        </div>
    </div>

    <!-- Add/Edit Webapp Modal -->
    <div id="appModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add New Webapp</h2>
                <span class="close">&times;</span>
            </div>
            <form id="appForm">
                <div class="form-group">
                    <label for="appName">Name *</label>
                    <input type="text" id="appName" required>
                </div>
                <div class="form-group">
                    <label for="appDescription">Description</label>
                    <textarea id="appDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="appFile">HTML File *</label>
                    <input type="file" id="appFile" accept=".html" required>
                    <small>Select the HTML file for your webapp</small>
                </div>
                <div class="form-group">
                    <label for="appCategory">Category</label>
                    <select id="appCategory">
                        <option value="other">Other</option>
			<option value="devtools">Dev Tools</option>
			<option value="research">Research</option>
                        <option value="productivity">Productivity</option>
                        <option value="utilities">Utilities</option>
                        <option value="fun">Fun</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="appTags">Tags</label>
                    <input type="text" id="appTags" placeholder="Comma-separated tags">
                </div>
                <div class="form-group">
                    <label for="appScreenshot">Custom Screenshot (optional)</label>
                    <input type="file" id="appScreenshot" accept="image/*">
                    <small>Upload a custom screenshot image (will override auto-generated screenshot)</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Webapp</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Delete Webapp</h2>
                <span class="close">&times;</span>
            </div>
            <p>Are you sure you want to delete this webapp? This action cannot be undone.</p>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="cancelDeleteBtn">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
            </div>
        </div>
    </div>

    <!-- Import/Export Modal -->
    <div id="importExportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="importExportTitle">Export Data</h2>
                <span class="close">&times;</span>
            </div>
            <div id="exportSection">
                <p>Choose the format to export your webapp data:</p>
                <div class="format-options">
                    <button id="exportJsonBtn" class="btn btn-primary">
                        <i class="fas fa-file-code"></i> Export as JSON
                    </button>
                    <button id="exportXmlBtn" class="btn btn-primary">
                        <i class="fas fa-file-code"></i> Export as XML
                    </button>
                </div>
            </div>
            <div id="importSection" style="display: none;">
                <p>Select a file to import webapp data:</p>
                <div class="form-group">
                    <label for="importFile">Import File (JSON or XML)</label>
                    <input type="file" id="importFile" accept=".json,.xml" required>
                    <small>Select a JSON or XML file exported from Monkey Spa</small>
                </div>
                <div class="import-options">
                    <label>
                        <input type="radio" name="importMode" value="merge" checked>
                        Merge with existing data
                    </label>
                    <label>
                        <input type="radio" name="importMode" value="replace">
                        Replace all existing data
                    </label>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelImportBtn">Cancel</button>
                    <button type="button" class="btn btn-primary" id="confirmImportBtn">Import Data</button>
                </div>
            </div>
        </div>
    </div>

    <script>
class WebappManager {
    constructor() {
        this.webapps = this.loadWebapps();
        this.currentEditId = null;
        this.pendingScreenshots = new Map(); // Track pending screenshot operations
        this.init();
    }

    init() {
        this.bindEvents();
        this.renderWebapps();
    }

    bindEvents() {
        // Modal controls
        document.getElementById('addAppBtn').addEventListener('click', () => this.openModal());
        document.querySelectorAll('.close').forEach(close => {
            close.addEventListener('click', () => this.closeModals());
        });
        document.getElementById('cancelBtn').addEventListener('click', () => this.closeModals());
        document.getElementById('cancelDeleteBtn').addEventListener('click', () => this.closeModals());

        // Form submission
        document.getElementById('appForm').addEventListener('submit', (e) => this.handleFormSubmit(e));
        
        // Delete confirmation
        document.getElementById('confirmDeleteBtn').addEventListener('click', () => this.confirmDelete());

        // Import/Export functionality
        document.getElementById('exportBtn').addEventListener('click', () => this.openExportModal());
        document.getElementById('importBtn').addEventListener('click', () => this.openImportModal());
        document.getElementById('exportJsonBtn').addEventListener('click', () => this.exportData('json'));
        document.getElementById('exportXmlBtn').addEventListener('click', () => this.exportData('xml'));
        document.getElementById('confirmImportBtn').addEventListener('click', () => this.importData());
        document.getElementById('cancelImportBtn').addEventListener('click', () => this.closeImportExportModal());

        // Search and filters
        document.getElementById('searchInput').addEventListener('input', () => this.filterWebapps());
        document.getElementById('sortSelect').addEventListener('change', () => this.filterWebapps());
        document.getElementById('categoryFilter').addEventListener('change', () => this.filterWebapps());

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                if (e.target.id === 'importExportModal') {
                    this.closeImportExportModal();
                } else {
                    this.closeModals();
                }
            }
        });
    }

    loadWebapps() {
        const stored = localStorage.getItem('webapps');
        const webapps = stored ? JSON.parse(stored) : [];
        console.log('LOAD: Loaded webapps from localStorage:', webapps.map(app => ({id: app.id, name: app.name, screenshotType: app.screenshot?.type})));
        return webapps;
    }

    saveWebapps() {
        console.log('Saving webapps to localStorage:', this.webapps.map(app => ({id: app.id, name: app.name, screenshotType: app.screenshot?.type})));
        localStorage.setItem('webapps', JSON.stringify(this.webapps));
    }

    generateId() {
        return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }

    openModal(webapp = null) {
        const modal = document.getElementById('appModal');
        const title = document.getElementById('modalTitle');
        const form = document.getElementById('appForm');

        if (webapp) {
            title.textContent = 'Edit Webapp';
            this.currentEditId = webapp.id;
            console.log('MODAL: Setting currentEditId to:', this.currentEditId);
            console.log('MODAL: Webapp being edited:', webapp.name, webapp.id);
            this.populateForm(webapp);
        } else {
            title.textContent = 'Add New Webapp';
            this.currentEditId = null;
            form.reset();
        }

        modal.style.display = 'block';
    }

    populateForm(webapp) {
        document.getElementById('appName').value = webapp.name;
        document.getElementById('appDescription').value = webapp.description || '';
        document.getElementById('appCategory').value = webapp.category || 'other';
        document.getElementById('appTags').value = webapp.tags ? webapp.tags.join(', ') : '';
        
        // Note: File input cannot be pre-populated for security reasons
        const fileInput = document.getElementById('appFile');
        fileInput.removeAttribute('required');
        fileInput.value = ''; // Clear any previous file selection
        
        // Clear screenshot input to prevent cross-contamination
        const screenshotInput = document.getElementById('appScreenshot');
        screenshotInput.value = '';
        
        console.log('FORM: Populated form for webapp:', webapp.name, webapp.id);
    }

    closeModals() {
        document.getElementById('appModal').style.display = 'none';
        document.getElementById('deleteModal').style.display = 'none';
        this.currentEditId = null;
    }

    closeImportExportModal() {
        document.getElementById('importExportModal').style.display = 'none';
    }

    openExportModal() {
        document.getElementById('importExportTitle').textContent = 'Export Data';
        document.getElementById('exportSection').style.display = 'block';
        document.getElementById('importSection').style.display = 'none';
        document.getElementById('importExportModal').style.display = 'block';
    }

    openImportModal() {
        document.getElementById('importExportTitle').textContent = 'Import Data';
        document.getElementById('exportSection').style.display = 'none';
        document.getElementById('importSection').style.display = 'block';
        document.getElementById('importFile').value = '';
        document.getElementById('importExportModal').style.display = 'block';
    }

    exportData(format) {
        try {
            const exportData = {
                version: '1.0',
                exportDate: new Date().toISOString(),
                webapps: this.webapps.map(webapp => ({
                    ...webapp,
                    // Include metadata for import validation
                    exportedFrom: 'MonkeySpa'
                }))
            };

            let content, filename, mimeType;

            if (format === 'json') {
                content = JSON.stringify(exportData, null, 2);
                filename = `monkey-spa-export-${new Date().toISOString().split('T')[0]}.json`;
                mimeType = 'application/json';
            } else if (format === 'xml') {
                content = this.convertToXML(exportData);
                filename = `monkey-spa-export-${new Date().toISOString().split('T')[0]}.xml`;
                mimeType = 'application/xml';
            }

            this.downloadFile(content, filename, mimeType);
            this.closeImportExportModal();
            this.showNotification(`Data exported successfully as ${format.toUpperCase()}!`, 'success');
        } catch (error) {
            console.error('Export error:', error);
            this.showNotification('Failed to export data. Please try again.', 'error');
        }
    }

    convertToXML(data) {
        let xml = '<?xml version="1.0" encoding="UTF-8"?>\n';
        xml += '<MonkeySpaExport>\n';
        xml += `  <version>${data.version}</version>\n`;
        xml += `  <exportDate>${data.exportDate}</exportDate>\n`;
        xml += '  <webapps>\n';
        
        data.webapps.forEach(webapp => {
            xml += '    <webapp>\n';
            xml += `      <id>${this.escapeXML(webapp.id)}</id>\n`;
            xml += `      <name>${this.escapeXML(webapp.name)}</name>\n`;
            xml += `      <description>${this.escapeXML(webapp.description || '')}</description>\n`;
            xml += `      <category>${this.escapeXML(webapp.category)}</category>\n`;
            xml += `      <fileName>${this.escapeXML(webapp.fileName)}</fileName>\n`;
            xml += `      <fileContent><![CDATA[${webapp.fileContent}]]></fileContent>\n`;
            xml += `      <dateAdded>${webapp.dateAdded}</dateAdded>\n`;
            xml += `      <lastUsed>${webapp.lastUsed || ''}</lastUsed>\n`;
            xml += `      <lastModified>${webapp.lastModified}</lastModified>\n`;
            xml += `      <usageCount>${webapp.usageCount || 0}</usageCount>\n`;
            xml += `      <exportedFrom>${this.escapeXML(webapp.exportedFrom)}</exportedFrom>\n`;
            
            if (webapp.tags && webapp.tags.length > 0) {
                xml += '      <tags>\n';
                webapp.tags.forEach(tag => {
                    xml += `        <tag>${this.escapeXML(tag)}</tag>\n`;
                });
                xml += '      </tags>\n';
            }
            
            if (webapp.screenshot) {
                xml += '      <screenshot>\n';
                xml += `        <type>${this.escapeXML(webapp.screenshot.type)}</type>\n`;
                if (webapp.screenshot.url) {
                    xml += `        <url><![CDATA[${webapp.screenshot.url}]]></url>\n`;
                }
                if (webapp.screenshot.title) {
                    xml += `        <title>${this.escapeXML(webapp.screenshot.title)}</title>\n`;
                }
                if (webapp.screenshot.preview) {
                    xml += `        <preview>${this.escapeXML(webapp.screenshot.preview)}</preview>\n`;
                }
                xml += '      </screenshot>\n';
            }
            
            xml += '    </webapp>\n';
        });
        
        xml += '  </webapps>\n';
        xml += '</MonkeySpaExport>';
        return xml;
    }

    escapeXML(str) {
        if (!str) return '';
        return str.toString()
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;');
    }

    downloadFile(content, filename, mimeType) {
        const blob = new Blob([content], { type: mimeType });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    }

    async importData() {
        const fileInput = document.getElementById('importFile');
        const importMode = document.querySelector('input[name="importMode"]:checked').value;
        
        if (!fileInput.files[0]) {
            this.showNotification('Please select a file to import.', 'error');
            return;
        }

        const file = fileInput.files[0];
        const isJSON = file.name.toLowerCase().endsWith('.json');
        const isXML = file.name.toLowerCase().endsWith('.xml');
        
        if (!isJSON && !isXML) {
            this.showNotification('Please select a valid JSON or XML file.', 'error');
            return;
        }

        try {
            const content = await this.readFileContent(file);
            let importedData;

            if (isJSON) {
                importedData = JSON.parse(content);
            } else {
                importedData = this.parseXML(content);
            }

            // Validate imported data
            if (!this.validateImportData(importedData)) {
                this.showNotification('Invalid file format. Please select a valid Monkey Spa export file.', 'error');
                return;
            }

            // Process import based on mode
            if (importMode === 'replace') {
                this.webapps = importedData.webapps;
            } else {
                // Merge mode - avoid duplicates by ID
                const existingIds = new Set(this.webapps.map(app => app.id));
                const newWebapps = importedData.webapps.filter(app => !existingIds.has(app.id));
                this.webapps = [...this.webapps, ...newWebapps];
            }

            this.saveWebapps();
            this.renderWebapps();
            this.closeImportExportModal();
            
            const count = importedData.webapps.length;
            const mode = importMode === 'replace' ? 'replaced' : 'merged';
            this.showNotification(`Successfully ${mode} ${count} webapp(s)!`, 'success');
            
        } catch (error) {
            console.error('Import error:', error);
            this.showNotification('Failed to import data. Please check the file format.', 'error');
        }
    }

    parseXML(xmlString) {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xmlString, 'text/xml');
        
        if (xmlDoc.getElementsByTagName('parsererror').length > 0) {
            throw new Error('Invalid XML format');
        }

        const exportData = {
            version: xmlDoc.querySelector('version')?.textContent || '1.0',
            exportDate: xmlDoc.querySelector('exportDate')?.textContent || new Date().toISOString(),
            webapps: []
        };

        const webappElements = xmlDoc.querySelectorAll('webapp');
        webappElements.forEach(webappEl => {
            const webapp = {
                id: webappEl.querySelector('id')?.textContent,
                name: webappEl.querySelector('name')?.textContent,
                description: webappEl.querySelector('description')?.textContent || '',
                category: webappEl.querySelector('category')?.textContent || 'other',
                fileName: webappEl.querySelector('fileName')?.textContent,
                fileContent: webappEl.querySelector('fileContent')?.textContent,
                dateAdded: webappEl.querySelector('dateAdded')?.textContent,
                lastUsed: webappEl.querySelector('lastUsed')?.textContent || null,
                lastModified: webappEl.querySelector('lastModified')?.textContent,
                usageCount: parseInt(webappEl.querySelector('usageCount')?.textContent) || 0,
                exportedFrom: webappEl.querySelector('exportedFrom')?.textContent
            };

            // Parse tags
            const tagElements = webappEl.querySelectorAll('tags tag');
            webapp.tags = Array.from(tagElements).map(tag => tag.textContent);

            // Parse screenshot
            const screenshotEl = webappEl.querySelector('screenshot');
            if (screenshotEl) {
                webapp.screenshot = {
                    type: screenshotEl.querySelector('type')?.textContent,
                    url: screenshotEl.querySelector('url')?.textContent,
                    title: screenshotEl.querySelector('title')?.textContent,
                    preview: screenshotEl.querySelector('preview')?.textContent
                };
            }

            exportData.webapps.push(webapp);
        });

        return exportData;
    }

    validateImportData(data) {
        return data && 
               data.webapps && 
               Array.isArray(data.webapps) &&
               data.webapps.every(webapp => 
                   webapp.id && 
                   webapp.name && 
                   webapp.fileContent
               );
    }

    showNotification(message, type = 'info') {
        // Create notification element
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;
        notification.innerHTML = `
            <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
            <span>${message}</span>
        `;
        
        // Add to page
        document.body.appendChild(notification);
        
        // Show notification
        setTimeout(() => notification.classList.add('show'), 100);
        
        // Remove after 4 seconds
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => document.body.removeChild(notification), 300);
        }, 4000);
    }

    async handleFormSubmit(e) {
        e.preventDefault();
        
        const name = document.getElementById('appName').value.trim();
        const description = document.getElementById('appDescription').value.trim();
        const category = document.getElementById('appCategory').value;
        const tags = document.getElementById('appTags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
        const fileInput = document.getElementById('appFile');
        const screenshotInput = document.getElementById('appScreenshot');

        if (!name) {
            alert('Please enter a webapp name');
            return;
        }

        // Show loading state
        const submitBtn = e.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';

        try {
            if (this.currentEditId) {
                // Editing existing webapp - use dedicated method
                await this.updateExistingWebapp(this.currentEditId, name, description, category, tags, fileInput, screenshotInput);
            } else {
                // Adding new webapp - use dedicated method
                await this.addNewWebapp(name, description, category, tags, fileInput, screenshotInput);
            }
        } catch (error) {
            console.error('Error processing webapp:', error);
            alert('An error occurred while processing the webapp. Please try again.');
        } finally {
            // Reset button state
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        }
    }

    async updateExistingWebapp(webappId, name, description, category, tags, fileInput, screenshotInput) {
        console.log(`UPDATE: Starting update for webapp ${webappId}`);
        
        // Create a completely new webapp object to avoid any reference issues
        const originalWebapp = this.webapps.find(app => app.id === webappId);
        if (!originalWebapp) {
            console.error('UPDATE: Webapp not found:', webappId);
            return;
        }

        console.log('UPDATE: Original webapp:', originalWebapp.name, originalWebapp.screenshot?.type);

        // Deep clone the original webapp to avoid reference issues
        const updatedWebapp = JSON.parse(JSON.stringify(originalWebapp));
        updatedWebapp.name = name;
        updatedWebapp.description = description;
        updatedWebapp.category = category;
        updatedWebapp.tags = [...tags]; // Create new array
        updatedWebapp.lastModified = new Date().toISOString();

        console.log('UPDATE: Updated webapp object:', updatedWebapp.name, updatedWebapp.screenshot?.type);

        // Replace the webapp in the array using map to avoid index issues
        this.webapps = this.webapps.map(app => {
            if (app.id === webappId) {
                return updatedWebapp;
            }
            return app;
        });

        // Handle custom screenshot upload
        if (screenshotInput.files[0]) {
            console.log('UPDATE: Custom screenshot provided');
            const customScreenshot = await this.processCustomScreenshot(screenshotInput.files[0]);
            this.webapps = this.webapps.map(app => {
                if (app.id === webappId) {
                    return { ...app, screenshot: customScreenshot };
                }
                return app;
            });
        }

        // Handle file update ONLY if user actually selected a new file during this edit session
        console.log('UPDATE: Checking file input - files:', fileInput.files.length, 'value:', fileInput.value);
        if (fileInput.files[0] && fileInput.value !== '') {
            const file = fileInput.files[0];
            const fileContent = await this.readFileContent(file);
            
            // Cancel any pending screenshot for this webapp
            if (this.pendingScreenshots.has(webappId)) {
                this.pendingScreenshots.get(webappId).cancelled = true;
            }
            
            // Update the webapp using map to avoid index corruption
            this.webapps = this.webapps.map(app => {
                if (app.id === webappId) {
                    return {
                        ...app,
                        fileContent,
                        fileName: file.name,
                        screenshot: { type: 'loading' }
                    };
                }
                return app;
            });
            
            this.saveWebapps();
            this.renderWebapps();
            
            // Create new cancellation token
            const cancellationToken = { cancelled: false };
            this.pendingScreenshots.set(webappId, cancellationToken);
            
            // Generate new screenshot
            const screenshot = await this.generateScreenshot(fileContent);
            if (!cancellationToken.cancelled) {
                // Use map to avoid index issues
                this.webapps = this.webapps.map(app => {
                    if (app.id === webappId) {
                        return { ...app, screenshot };
                    }
                    return app;
                });
            }
            this.pendingScreenshots.delete(webappId);
        }

        const finalWebapp = this.webapps.find(app => app.id === webappId);
        console.log('UPDATE: Final webapp state:', finalWebapp?.name, finalWebapp?.screenshot?.type);
        this.saveWebapps();
        this.renderWebapps();
        this.closeModals();
    }

    async addNewWebapp(name, description, category, tags, fileInput, screenshotInput) {
        if (!fileInput.files[0]) {
            alert('Please select an HTML file');
            return;
        }

        const file = fileInput.files[0];
        const fileContent = await this.readFileContent(file);
        const webappId = this.generateId();

        const newWebapp = {
            id: webappId,
            name,
            description,
            category,
            tags,
            fileName: file.name,
            fileContent,
            screenshot: { type: 'loading' },
            dateAdded: new Date().toISOString(),
            lastUsed: null,
            lastModified: new Date().toISOString(),
            usageCount: 0
        };

        this.webapps.push(newWebapp);
        this.saveWebapps();
        this.renderWebapps();
        this.closeModals();

        // Handle custom screenshot if provided
        if (screenshotInput.files[0]) {
            console.log('NEW: Custom screenshot provided');
            const customScreenshot = await this.processCustomScreenshot(screenshotInput.files[0]);
            this.webapps = this.webapps.map(app => {
                if (app.id === webappId) {
                    return { ...app, screenshot: customScreenshot };
                }
                return app;
            });
            this.saveWebapps();
            this.renderWebapps();
            return; // Skip auto-generated screenshot
        }

        // Cancel any existing screenshot generation for this webapp
        if (this.pendingScreenshots.has(webappId)) {
            console.log(`ASYNC: Cancelling existing screenshot generation for ${webappId}`);
            this.pendingScreenshots.get(webappId).cancelled = true;
        }

        // Create cancellation token
        const cancellationToken = { cancelled: false };
        this.pendingScreenshots.set(webappId, cancellationToken);

        // Generate screenshot in background using ID lookup
        this.generateScreenshot(fileContent).then(screenshot => {
            // Check if this operation was cancelled
            if (cancellationToken.cancelled) {
                console.log(`ASYNC: Screenshot generation cancelled for webapp ${webappId}`);
                return;
            }

            console.log(`ASYNC: Setting screenshot for webapp ${webappId}`);
            console.log('ASYNC: Current webapps state:', this.webapps.map(app => ({id: app.id, name: app.name})));
            
            // Use map to create a new array with the updated webapp
            this.webapps = this.webapps.map(app => {
                if (app.id === webappId) {
                    console.log(`ASYNC: Found target webapp: ${app.name} (ID: ${app.id}), updating screenshot`);
                    console.log('ASYNC: Screenshot being applied to:', app.name);
                    return { ...app, screenshot };
                }
                return app;
            });
            
            this.saveWebapps();
            this.renderWebapps();
            
            // Clean up cancellation token
            this.pendingScreenshots.delete(webappId);
        }).catch(error => {
            console.error('Screenshot generation failed:', error);
            this.pendingScreenshots.delete(webappId);
        });
    }

    async processCustomScreenshot(imageFile) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = (e) => {
                resolve({
                    type: 'image',
                    url: e.target.result,
                    title: 'Custom Screenshot'
                });
            };
            reader.onerror = reject;
            reader.readAsDataURL(imageFile);
        });
    }

    readFileContent(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = e => resolve(e.target.result);
            reader.onerror = reject;
            reader.readAsText(file);
        });
    }

    async generateScreenshot(htmlContent) {
        return new Promise((resolve) => {
            // Create a hidden iframe to render the HTML content
            const iframe = document.createElement('iframe');
            iframe.style.position = 'absolute';
            iframe.style.left = '-9999px';
            iframe.style.width = '1024px';
            iframe.style.height = '768px';
            iframe.style.border = 'none';
            
            document.body.appendChild(iframe);
            
            // Write the HTML content to the iframe
            iframe.contentDocument.open();
            iframe.contentDocument.write(htmlContent);
            iframe.contentDocument.close();
            
            // Wait for content to load, then capture screenshot
            iframe.onload = () => {
                // Increased delay to ensure full page rendering (CSS, images, etc.)
                setTimeout(() => {
                    html2canvas(iframe.contentDocument.documentElement, {
                        width: 1024,
                        height: 768,
                        scale: 0.5,
                        useCORS: true,
                        allowTaint: true,
                        backgroundColor: null,
                        foreignObjectRendering: false,
                        logging: false,
                        removeContainer: true,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: 1024,
                        windowHeight: 768
                    }).then(canvas => {
                        const screenshot = canvas.toDataURL('image/png');
                        document.body.removeChild(iframe);
                        
                        resolve({
                            type: 'image',
                            url: screenshot,
                            title: this.extractTitle(htmlContent)
                        });
                    }).catch(error => {
                        console.warn('Screenshot generation failed:', error);
                        document.body.removeChild(iframe);
                        
                        // Fallback to text preview
                        resolve({
                            type: 'text',
                            title: this.extractTitle(htmlContent),
                            preview: htmlContent.substring(0, 200) + '...'
                        });
                    });
                }, 2000); // Wait 2 seconds for content to render
            };
            
            // Fallback if iframe fails to load
            iframe.onerror = () => {
                document.body.removeChild(iframe);
                resolve({
                    type: 'text',
                    title: this.extractTitle(htmlContent),
                    preview: htmlContent.substring(0, 200) + '...'
                });
            };
        });
    }

    extractTitle(htmlContent) {
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlContent, 'text/html');
        return doc.querySelector('title')?.textContent || 'Untitled Webapp';
    }

    launchWebapp(webapp) {
        // Update usage statistics using map to avoid reference issues
        this.webapps = this.webapps.map(app => {
            if (app.id === webapp.id) {
                return {
                    ...app,
                    lastUsed: new Date().toISOString(),
                    usageCount: (app.usageCount || 0) + 1
                };
            }
            return app;
        });
        
        this.saveWebapps();
        this.renderWebapps(); // Re-render to show updated "last used" time

        // Create a new window/tab with the webapp content
        const newWindow = window.open('', '_blank');
        newWindow.document.write(webapp.fileContent);
        newWindow.document.close();
    }

    editWebapp(webapp) {
        console.log('EDIT: Opening edit modal for webapp:', webapp.id, webapp.name);
        console.log('EDIT: Webapp screenshot type:', webapp.screenshot?.type);
        this.openModal(webapp);
    }

    deleteWebapp(webapp) {
        this.webappToDelete = webapp;
        document.getElementById('deleteModal').style.display = 'block';
    }

    confirmDelete() {
        if (this.webappToDelete) {
            this.webapps = this.webapps.filter(app => app.id !== this.webappToDelete.id);
            this.saveWebapps();
            this.renderWebapps();
            this.webappToDelete = null;
        }
        this.closeModals();
    }

    filterWebapps() {
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        const sortBy = document.getElementById('sortSelect').value;
        const categoryFilter = document.getElementById('categoryFilter').value;

        let filtered = this.webapps.filter(webapp => {
            const matchesSearch = !searchTerm || 
                webapp.name.toLowerCase().includes(searchTerm) ||
                webapp.description?.toLowerCase().includes(searchTerm) ||
                webapp.tags?.some(tag => tag.toLowerCase().includes(searchTerm));

            const matchesCategory = !categoryFilter || webapp.category === categoryFilter;

            return matchesSearch && matchesCategory;
        });

        // Sort the filtered results
        filtered.sort((a, b) => {
            switch (sortBy) {
                case 'name':
                    return a.name.localeCompare(b.name);
                case 'lastUsed':
                    const aLastUsed = a.lastUsed || '0';
                    const bLastUsed = b.lastUsed || '0';
                    return new Date(bLastUsed) - new Date(aLastUsed);
                case 'dateAdded':
                default:
                    return new Date(b.dateAdded) - new Date(a.dateAdded);
            }
        });

        this.renderWebapps(filtered);
    }

    renderWebapps(webappsToRender = null) {
        const grid = document.getElementById('webappGrid');
        const emptyState = document.getElementById('emptyState');
        const webapps = webappsToRender || this.webapps;

        if (webapps.length === 0) {
            grid.style.display = 'none';
            emptyState.style.display = 'block';
            return;
        }

        grid.style.display = 'grid';
        emptyState.style.display = 'none';

        grid.innerHTML = webapps.map(webapp => this.createWebappCard(webapp)).join('');

        // Bind events for the newly created cards
        webapps.forEach(webapp => {
            const card = document.querySelector(`[data-id="${webapp.id}"]`);
            const launchArea = card.querySelector('.webapp-screenshot, .webapp-info');
            const editBtn = card.querySelector('.edit');
            const deleteBtn = card.querySelector('.delete');

            launchArea.addEventListener('click', (e) => {
                if (!e.target.closest('.webapp-actions')) {
                    this.launchWebapp(webapp);
                }
            });

            editBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                this.editWebapp(webapp);
            });

            deleteBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                this.deleteWebapp(webapp);
            });
        });
    }

    createWebappCard(webapp) {
        const formatDate = (dateString) => {
            if (!dateString) return 'Never';
            return new Date(dateString).toLocaleDateString();
        };

        const getCategoryColor = (category) => {
            const colors = {
                productivity: '#48bb78',
                fun: '#ed8936',
                utilities: '#4299e1',
                research: '#9f7aea',
                devtools: '#ff8463',
                other: '#667eea'
            };
            return colors[category] || colors.other;
        };

        return `
            <div class="webapp-card" data-id="${webapp.id}">
                <div class="webapp-screenshot ${webapp.screenshot?.type === 'loading' ? 'loading' : ''}">
                    ${webapp.screenshot?.type === 'image' 
                        ? `<img src="${webapp.screenshot.url}" alt="${webapp.name} screenshot">` 
                        : webapp.screenshot?.type === 'loading'
                        ? `<div class="loading-spinner"></div><div class="loading-text">Generating screenshot...</div>`
                        : `<i class="fas fa-code placeholder-icon"></i>`
                    }
                </div>
                <div class="webapp-info">
                    <div class="webapp-title">
                        ${webapp.name}
                        <div class="webapp-actions">
                            <button class="action-btn edit" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    ${webapp.description ? `<div class="webapp-description">${webapp.description}</div>` : ''}
                    <div class="webapp-meta">
                        <span class="webapp-category" style="background-color: ${getCategoryColor(webapp.category)}">
                            ${webapp.category}
                        </span>
                        <span>Added: ${formatDate(webapp.dateAdded)}</span>
                    </div>
                    <div class="webapp-meta">
                        <span>Last used: ${formatDate(webapp.lastUsed)}</span>
                        <span>Uses: ${webapp.usageCount || 0}</span>
                    </div>
                    ${webapp.tags && webapp.tags.length > 0 ? `
                        <div class="webapp-tags">
                            ${webapp.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    ` : ''}
                </div>
            </div>
        `;
    }
}

// Initialize the webapp manager when the page loads
document.addEventListener('DOMContentLoaded', () => {
    new WebappManager();
});
    </script>
</body>
</html>
